{"cells":[{"cell_type":"code","metadata":{},"source":"%%configure -n project.spark.compatibility\n{\n    \"number_of_workers\": 4,\n    \"session_type\": \"etl\",\n    \"glue_version\": \"5.0\",\n    \"worker_type\": \"G.1X\",\n    \"idle_timeout\": 5,\n    \"timeout\": 60,\n    \"--enable-glue-datacatalog\": \"true\",\n    \"--enable-auto-scaling\": \"true\",\n    \"--project_s3_path\": \"s3://amazon-sagemaker-577638381635-sa-east-1-3a24c0d9beaf/dzd_cjfgk2iz50fxp7/5ogmezbasmyi6z/dev\",\n    \"--redshift_iam_role\": \"arn:aws:iam::577638381635:role/datazone_usr_role_5ogmezbasmyi6z_6kizdce0xmbvyz\",\n    \"--redshift_tempdir\": \"s3://amazon-sagemaker-577638381635-sa-east-1-3a24c0d9beaf/dzd_cjfgk2iz50fxp7/5ogmezbasmyi6z/dev/redshift-tmp/\",\n    \"--enable-lakeformation-fine-grained-access\": \"false\",\n    \"--datalake-formats\": \"iceberg\"\n}","execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{},"source":"%%pyspark project.spark.compatibility\nimport sys\nfrom awsglue.transforms import *\nfrom pyspark.context import SparkContext\nfrom pyspark.sql import SparkSession\nfrom pyspark.sql.functions import *\n\nfrom awsglue.utils import getResolvedOptions\nfrom pyspark.sql.functions import *\nfrom awsglue.context import GlueContext\nfrom awsglue.job import Job\nimport json","execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{},"source":"%%pyspark project.spark.compatibility\nsc = SparkContext.getOrCreate()\nspark = SparkSession.builder.getOrCreate()\n","execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{},"source":"%%pyspark project.spark\n# Script generated for node CatalogDataSource\nCatalogDataSource_1741735513513 = spark.sql(\"select * from `glue_db_ay30a66r3fs2sb`.`customers_details_raw`\")","execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{},"source":"%%pyspark project.spark\nfrom pyspark.sql.functions import *\n\n# Script generated for node WithColumnsTransform\nWithColumnsTransform_1741735846342 = CatalogDataSource_1741735513513.withColumns({\"customer_id\": col(\"customer_id\").cast(\"bigint\"), \"first_name\": col(\"first_name\").cast(\"string\"), \"last_name\": col(\"last_name\").cast(\"string\"), \"date_of_birth\": col(\"date_of_birth\").cast(\"date\"), \"email\": col(\"email\").cast(\"string\"), \"phone_number\": col(\"phone_number\").cast(\"string\"), \"employment_status\": col(\"employment_status\").cast(\"string\"), \"annual_income\": col(\"annual_income\").cast(\"decimal\"), \"created_at\": col(\"created_at\").cast(\"timestamp\"), \"updated_at\": col(\"updated_at\").cast(\"timestamp\")})","execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{},"source":"%%pyspark project.spark\n# Script generated for node FilterTransform\nFilterTransform_1741737341721 = WithColumnsTransform_1741735846342.filter(\"`first_name` != 'first_name'\")","execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{},"source":"%%pyspark project.spark\ndef get_table_columns(spark, database_name, table_name):\n    schema_df = spark.sql(f\"DESCRIBE `{database_name}`.`{table_name}`\").collect()\n\n    # Check if '# Partition Information' is present\n    partition_info_exists = any(row.col_name == '# Partition Information' for row in schema_df)\n\n    if partition_info_exists:\n        # Find the index where partition information starts\n        partition_index = next(i for i, row in enumerate(schema_df) if row.col_name == '# Partition Information')\n        all_columns = [row.col_name for row in schema_df[:partition_index] if row.col_name]\n    else:\n        all_columns = [row.col_name for row in schema_df if row.col_name]\n\n    return all_columns\n\n\n# Script generated for node CatalogDataSink\nall_columns = get_table_columns(spark, \"glue_db_ay30a66r3fs2sb\", \"customer\")\n# enforce the column number and column order by getting all column names from DESCRIBE TABLE query and doing a select first.\nassert len(FilterTransform_1741737341721.columns) == len(all_columns), \"the input df has different col number than the target catalog table.\"\nFilterTransform_1741737341721.select(all_columns).write.insertInto(\"`glue_db_ay30a66r3fs2sb`.`customer`\")","execution_count":0,"outputs":[]}],"metadata":{"kernelspec":{"display_name":"Python 3 (ipykernel)","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.10.14"},"maxdomeModel":{"nodes":[{"type":"MaxDomeBasicNode","id":"1741735846342","position":{"x":-1001.6182384206222,"y":-535.234375},"data":{"label":"Change columns","nodeDescription":"Change data types or add custom expressions to modify column values.","iconName":"custom_column_operations","type":"transformWithColumns","classification":"Transform","senseiType":"WithColumns","inputShape":{"total":1},"fields":[{"fieldName":"dataTypeCast","fieldLabel":"Type casting","type":"custom","value":[{"targetColumn":"customer_id","targetType":"bigint","sourceColumn":"customer_id"},{"targetColumn":"first_name","targetType":"string","sourceColumn":"first_name"},{"targetColumn":"last_name","targetType":"string","sourceColumn":"last_name"},{"targetColumn":"date_of_birth","targetType":"date","sourceColumn":"date_of_birth"},{"targetColumn":"email","targetType":"string","sourceColumn":"email"},{"targetColumn":"phone_number","targetType":"string","sourceColumn":"phone_number"},{"targetColumn":"employment_status","targetType":"string","sourceColumn":"employment_status"},{"targetColumn":"annual_income","targetType":"decimal","sourceColumn":"annual_income"},{"targetColumn":"created_at","targetType":"timestamp","sourceColumn":"created_at"},{"targetColumn":"updated_at","targetType":"timestamp","sourceColumn":"updated_at"}],"validator":{"_def":{"type":{"_def":{"unknownKeys":"strip","catchall":{"_def":{"typeName":"ZodNever"}},"typeName":"ZodObject"},"_cached":{"shape":{"targetColumn":{"_def":{"checks":[{"kind":"min","value":1}],"typeName":"ZodString","coerce":false}},"targetType":{"_def":{"checks":[{"kind":"min","value":1}],"typeName":"ZodString","coerce":false}},"sourceColumn":{"_def":{"checks":[{"kind":"min","value":1}],"typeName":"ZodString","coerce":false}}},"keys":["targetColumn","targetType","sourceColumn"]}},"minLength":{"value":0},"maxLength":null,"exactLength":null,"typeName":"ZodArray"}},"customType":"customWithColumnsDataTypeCastTransform"},{"fieldName":"customExpression","fieldLabel":"Custom expression","type":"custom","value":[],"validator":{"_def":{"type":{"_def":{"unknownKeys":"strip","catchall":{"_def":{"typeName":"ZodNever"}},"typeName":"ZodObject"},"_cached":null},"minLength":{"value":0},"maxLength":null,"exactLength":null,"typeName":"ZodArray"}},"customType":"customWithColumnsExpressionTransform"}]},"measured":{"width":225,"height":56},"selected":false,"dragging":false},{"type":"MaxDomeBasicNode","id":"1741736080926","position":{"x":-442.69558107511665,"y":-535.234375},"data":{"label":"Amazon SageMaker Lakehouse","nodeDescription":"Write into a table in your Lakehouse catalogs.","iconName":"lakehouse_colored","type":"dataSinkSPARK_GLUE","classification":"DataSink","senseiType":"Catalog","inputShape":{"total":1},"fields":[{"fieldName":"options","fieldLabel":"Options","type":"custom","customType":"glueSinkSelector","value":{"catalog":"default","database":"glue_db_ay30a66r3fs2sb","table":"customer"},"validator":{"_def":{"unknownKeys":"strip","catchall":{"_def":{"typeName":"ZodNever"}},"typeName":"ZodObject"},"_cached":{"shape":{"catalog":{"_def":{"checks":[{"kind":"min","value":1,"message":"Required"}],"typeName":"ZodString","coerce":false}},"database":{"_def":{"checks":[{"kind":"min","value":1,"message":"Required"}],"typeName":"ZodString","coerce":false}},"table":{"_def":{"checks":[{"kind":"regex","regex":{}},{"kind":"min","value":1,"message":"Required"}],"typeName":"ZodString","coerce":false}}},"keys":["catalog","database","table"]}}}]},"measured":{"width":225,"height":56},"selected":true,"dragging":false},{"data":{"label":"Amazon SageMaker Lakehouse","nodeDescription":"Read from a table in your Lakehouse catalogs.","iconName":"lakehouse_colored","classification":"DataSource","senseiType":"Catalog","type":"dataSourceSPARK_GLUE","inputShape":{"total":0},"fields":[{"fieldName":"options","fieldLabel":"Options","type":"custom","customType":"glueTableQuerySelector","value":{"catalog":"default","database":"glue_db_ay30a66r3fs2sb","table":"customers_details_raw","query":"","inputType":"database/table"},"validator":{"_def":{"typeName":"ZodDiscriminatedUnion","discriminator":"inputType","options":[{"_def":{"unknownKeys":"strip","catchall":{"_def":{"typeName":"ZodNever"}},"typeName":"ZodObject"},"_cached":{"shape":{"inputType":{"_def":{"value":"database/table","typeName":"ZodLiteral"}},"catalog":{"_def":{"checks":[{"kind":"min","value":1,"message":"Required"}],"typeName":"ZodString","coerce":false}},"database":{"_def":{"checks":[{"kind":"min","value":1,"message":"Required"}],"typeName":"ZodString","coerce":false}},"table":{"_def":{"checks":[{"kind":"regex","regex":{}},{"kind":"min","value":1,"message":"Required"}],"typeName":"ZodString","coerce":false}}},"keys":["inputType","catalog","database","table"]}},{"_def":{"unknownKeys":"strip","catchall":{"_def":{"typeName":"ZodNever"}},"typeName":"ZodObject"},"_cached":null}],"optionsMap":[["database/table",{"_def":{"unknownKeys":"strip","catchall":{"_def":{"typeName":"ZodNever"}},"typeName":"ZodObject"},"_cached":{"shape":{"inputType":{"_def":{"value":"database/table","typeName":"ZodLiteral"}},"catalog":{"_def":{"checks":[{"kind":"min","value":1,"message":"Required"}],"typeName":"ZodString","coerce":false}},"database":{"_def":{"checks":[{"kind":"min","value":1,"message":"Required"}],"typeName":"ZodString","coerce":false}},"table":{"_def":{"checks":[{"kind":"regex","regex":{}},{"kind":"min","value":1,"message":"Required"}],"typeName":"ZodString","coerce":false}}},"keys":["inputType","catalog","database","table"]}}],["query",{"_def":{"unknownKeys":"strip","catchall":{"_def":{"typeName":"ZodNever"}},"typeName":"ZodObject"},"_cached":null}]]}}}]},"position":{"x":-1308.635223941532,"y":-535.234375},"type":"MaxDomeBasicNode","id":"1741735513513","measured":{"width":225,"height":56},"selected":false,"dragging":false},{"type":"MaxDomeBasicNode","id":"1741737341721","position":{"x":-723.6218658392128,"y":-535.234375},"data":{"label":"Filter","nodeDescription":"Filter data based on set conditions.","iconName":"filter_outlined","type":"transformFilter","classification":"Transform","senseiType":"Filter","inputShape":{"total":1},"fields":[{"fieldName":"filterType","fieldLabel":"Filter Type","type":"radio","value":"and","validator":{"_def":{"innerType":{"_def":{"checks":[],"typeName":"ZodString","coerce":false}},"typeName":"ZodOptional"}},"listOptions":[{"label":"Global AND","value":"and"},{"label":"Global OR","value":"or"}]},{"fieldName":"filterCondition","fieldLabel":"Filter Condition","type":"custom","customType":"filterConditionForm","value":[{"filterKey":"first_name","filterOperation":"!=","filterValue":"first_name"}],"validator":{"_def":{"type":{"_def":{"unknownKeys":"strip","catchall":{"_def":{"typeName":"ZodNever"}},"typeName":"ZodObject"},"_cached":{"shape":{"filterKey":{"_def":{"checks":[{"kind":"min","value":1,"message":"Required"}],"typeName":"ZodString","coerce":false}},"filterOperation":{"_def":{"checks":[{"kind":"min","value":1,"message":"Required"}],"typeName":"ZodString","coerce":false}},"filterValue":{"_def":{"checks":[{"kind":"min","value":1,"message":"Required"}],"typeName":"ZodString","coerce":false}}},"keys":["filterKey","filterOperation","filterValue"]}},"minLength":{"value":1},"maxLength":null,"exactLength":null,"typeName":"ZodArray"}}}]},"measured":{"width":225,"height":56},"selected":false,"dragging":false}],"edges":[{"source":"1741735513513","sourceHandle":"1741735513513-right-source","target":"1741735846342","targetHandle":"1741735846342-left-target","id":"1741735513513-1741735846342","type":"custom","data":{"hovering":false},"markerEnd":{"type":"arrowclosed"}},{"source":"1741735846342","sourceHandle":"1741735846342-right-source","target":"1741737341721","targetHandle":"1741737341721-left-target","id":"1741735846342-1741737341721","type":"custom","data":{"hovering":false},"markerEnd":{"type":"arrowclosed"}},{"source":"1741737341721","sourceHandle":"1741737341721-right-source","target":"1741736080926","targetHandle":"1741736080926-left-target","id":"1741737341721-1741736080926","type":"custom","data":{"hovering":false},"markerEnd":{"type":"arrowclosed"}}],"direction":"horizontal","engine":"Glue","viewport":{"x":1555.1654025083244,"y":1100.234375,"zoom":1},"interactiveSessionModel":{"additionalPythonModules":"","connections":[],"extraJars":[],"glueVersion":"5.0","extraPyFiles":[],"iamRole":"","numberOfWorkers":1,"sessionType":"etl","tags":{},"workerType":"G.025X","command":{"name":"glueetl","pythonVersion":"3"},"timeout":60,"idleTimeout":15},"name":"","version":"1.0.0","schemasMap":[["1741735513513",{"fields":[{"metadata":{},"name":"customer_id","nullable":true,"type":"long"},{"metadata":{},"name":"first_name","nullable":true,"type":"string"},{"metadata":{},"name":"last_name","nullable":true,"type":"string"},{"metadata":{},"name":"date_of_birth","nullable":true,"type":"string"},{"metadata":{},"name":"email","nullable":true,"type":"string"},{"metadata":{},"name":"phone_number","nullable":true,"type":"string"},{"metadata":{},"name":"employment_status","nullable":true,"type":"string"},{"metadata":{},"name":"annual_income","nullable":true,"type":"long"},{"metadata":{},"name":"created_at","nullable":true,"type":"string"},{"metadata":{},"name":"updated_at","nullable":true,"type":"string"}],"type":"struct"}],["1741735846342",{"fields":[{"metadata":{},"name":"customer_id","nullable":true,"type":"long"},{"metadata":{},"name":"first_name","nullable":true,"type":"string"},{"metadata":{},"name":"last_name","nullable":true,"type":"string"},{"metadata":{},"name":"date_of_birth","nullable":true,"type":"date"},{"metadata":{},"name":"email","nullable":true,"type":"string"},{"metadata":{},"name":"phone_number","nullable":true,"type":"string"},{"metadata":{},"name":"employment_status","nullable":true,"type":"string"},{"metadata":{},"name":"annual_income","nullable":true,"type":"decimal(10,0)"},{"metadata":{},"name":"created_at","nullable":true,"type":"timestamp"},{"metadata":{},"name":"updated_at","nullable":true,"type":"timestamp"}],"type":"struct"}],["1741735933013",{"type":"struct","fields":[]}],["1741737341721",{"fields":[{"metadata":{},"name":"customer_id","nullable":true,"type":"long"},{"metadata":{},"name":"first_name","nullable":true,"type":"string"},{"metadata":{},"name":"last_name","nullable":true,"type":"string"},{"metadata":{},"name":"date_of_birth","nullable":true,"type":"date"},{"metadata":{},"name":"email","nullable":true,"type":"string"},{"metadata":{},"name":"phone_number","nullable":true,"type":"string"},{"metadata":{},"name":"employment_status","nullable":true,"type":"string"},{"metadata":{},"name":"annual_income","nullable":true,"type":"decimal(10,0)"},{"metadata":{},"name":"created_at","nullable":true,"type":"timestamp"},{"metadata":{},"name":"updated_at","nullable":true,"type":"timestamp"}],"type":"struct"}]],"datasamplesMap":[["1741735513513",[{"annual_income":null,"created_at":"created_at","customer_id":null,"date_of_birth":"date_of_birth","email":"email","employment_status":"employment_status","first_name":"first_name","last_name":"last_name","phone_number":"phone_number","updated_at":"updated_at"},{"annual_income":75000,"created_at":"2022-01-15 08:30:00","customer_id":1,"date_of_birth":"1985-03-12","email":"joao.silva@email.com","employment_status":"Employed","first_name":"João","last_name":"Silva","phone_number":"+5511987654321","updated_at":"2022-11-28 14:15:22"},{"annual_income":92000,"created_at":"2022-02-03 10:15:45","customer_id":2,"date_of_birth":"1990-07-25","email":"maria.santos@email.com","employment_status":"Self-employed","first_name":"Maria","last_name":"Santos","phone_number":"+5511976543210","updated_at":"2022-10-12 09:34:17"},{"annual_income":68000,"created_at":"2022-02-10 14:20:33","customer_id":3,"date_of_birth":"1978-11-30","email":"carlos.ferreira@email.com","employment_status":"Employed","first_name":"Carlos","last_name":"Ferreira","phone_number":"+5521998765432","updated_at":"2022-09-05 16:45:08"},{"annual_income":0,"created_at":"2022-03-05 09:45:12","customer_id":4,"date_of_birth":"1992-05-18","email":"ana.oliveira@email.com","employment_status":"Unemployed","first_name":"Ana","last_name":"Oliveira","phone_number":"+5511965432109","updated_at":"2023-01-10 11:22:45"},{"annual_income":85000,"created_at":"2022-03-18 11:30:27","customer_id":5,"date_of_birth":"1983-09-07","email":"pedro.souza@email.com","employment_status":"Employed","first_name":"Pedro","last_name":"Souza","phone_number":"+5531987654321","updated_at":"2022-12-07 15:37:29"},{"annual_income":12000,"created_at":"2022-04-02 16:25:40","customer_id":6,"date_of_birth":"1995-01-22","email":"juliana.costa@email.com","employment_status":"Student","first_name":"Juliana","last_name":"Costa","phone_number":"+5511954321098","updated_at":"2023-02-15 10:18:33"},{"annual_income":110000,"created_at":"2022-04-20 13:10:55","customer_id":7,"date_of_birth":"1980-06-14","email":"rafael.almeida@email.com","employment_status":"Employed","first_name":"Rafael","last_name":"Almeida","phone_number":"+5541976543210","updated_at":"2022-08-30 17:29:41"},{"annual_income":78000,"created_at":"2022-05-08 15:45:22","customer_id":8,"date_of_birth":"1988-04-09","email":"fernanda.lima@email.com","employment_status":"Self-employed","first_name":"Fernanda","last_name":"Lima","phone_number":"+5511965432187","updated_at":"2023-01-25 09:48:12"},{"annual_income":95000,"created_at":"2022-05-17 10:35:18","customer_id":9,"date_of_birth":"1975-12-03","email":"bruno.martins@email.com","employment_status":"Employed","first_name":"Bruno","last_name":"Martins","phone_number":"+5521987654321","updated_at":"2022-12-19 14:56:38"},{"annual_income":0,"created_at":"2022-06-01 12:20:33","customer_id":10,"date_of_birth":"1993-08-16","email":"camila.rodrigues@email.com","employment_status":"Unemployed","first_name":"Camila","last_name":"Rodrigues","phone_number":"+5511976543219","updated_at":"2022-11-05 16:24:59"},{"annual_income":72000,"created_at":"2022-06-15 14:55:47","customer_id":11,"date_of_birth":"1982-02-28","email":"lucas.pereira@email.com","employment_status":"Employed","first_name":"Lucas","last_name":"Pereira","phone_number":"+5531998765432","updated_at":"2023-02-02 10:37:14"},{"annual_income":15000,"created_at":"2022-07-03 09:30:22","customer_id":12,"date_of_birth":"1991-10-11","email":"amanda.gomes@email.com","employment_status":"Student","first_name":"Amanda","last_name":"Gomes","phone_number":"+5511965432198","updated_at":"2022-09-28 15:42:31"},{"annual_income":120000,"created_at":"2022-07-18 11:15:45","customer_id":13,"date_of_birth":"1977-04-24","email":"diego.ribeiro@email.com","employment_status":"Self-employed","first_name":"Diego","last_name":"Ribeiro","phone_number":"+5551987654321","updated_at":"2023-01-15 13:19:47"},{"annual_income":65000,"created_at":"2022-08-02 15:40:12","customer_id":14,"date_of_birth":"1994-07-07","email":"patricia.castro@email.com","employment_status":"Employed","first_name":"Patricia","last_name":"Castro","phone_number":"+5511976543291","updated_at":"2022-12-10 11:28:33"},{"annual_income":88000,"created_at":"2022-08-20 10:25:38","customer_id":15,"date_of_birth":"1981-11-19","email":"gustavo.nunes@email.com","employment_status":"Employed","first_name":"Gustavo","last_name":"Nunes","phone_number":"+5521965432109","updated_at":"2023-02-20 16:44:22"},{"annual_income":0,"created_at":"2022-09-05 13:50:27","customer_id":16,"date_of_birth":"1989-03-02","email":"renata.barbosa@email.com","employment_status":"Unemployed","first_name":"Renata","last_name":"Barbosa","phone_number":"+5511987654329","updated_at":"2022-10-30 09:53:41"},{"annual_income":105000,"created_at":"2022-09-22 16:35:50","customer_id":17,"date_of_birth":"1976-08-15","email":"eduardo.cardoso@email.com","employment_status":"Employed","first_name":"Eduardo","last_name":"Cardoso","phone_number":"+5541976543219","updated_at":"2023-01-08 14:36:19"},{"annual_income":18000,"created_at":"2022-10-10 08:55:33","customer_id":18,"date_of_birth":"1993-01-31","email":"carla.nascimento@email.com","employment_status":"Student","first_name":"Carla","last_name":"Nascimento","phone_number":"+5511965432176","updated_at":"2022-12-25 17:21:48"},{"annual_income":96000,"created_at":"2022-10-28 12:40:18","customer_id":19,"date_of_birth":"1984-06-26","email":"ricardo.moreira@email.com","employment_status":"Self-employed","first_name":"Ricardo","last_name":"Moreira","phone_number":"+5531987654329","updated_at":"2023-02-10 11:45:27"},{"annual_income":70000,"created_at":"2022-11-15 14:15:42","customer_id":20,"date_of_birth":"1990-12-09","email":"vanessa.dias@email.com","employment_status":"Employed","first_name":"Vanessa","last_name":"Dias","phone_number":"+5511976543298","updated_at":"2023-01-30 15:38:55"},{"annual_income":82000,"created_at":"2022-12-03 10:30:15","customer_id":21,"date_of_birth":"1979-05-20","email":"fernando.rocha@email.com","employment_status":"Employed","first_name":"Fernando","last_name":"Rocha","phone_number":"+5521998765439","updated_at":"2023-02-25 10:22:14"},{"annual_income":0,"created_at":"2022-12-20 15:55:33","customer_id":22,"date_of_birth":"1995-09-04","email":"debora.cavalcanti@email.com","employment_status":"Unemployed","first_name":"Débora","last_name":"Cavalcanti","phone_number":"+5511965432165","updated_at":"2023-02-18 16:49:33"},{"annual_income":115000,"created_at":"2023-01-08 09:20:55","customer_id":23,"date_of_birth":"1981-02-17","email":"alessandro.vieira@email.com","employment_status":"Employed","first_name":"Alessandro","last_name":"Vieira","phone_number":"+5541987654328","updated_at":"2023-02-05 13:57:42"},{"annual_income":75000,"created_at":"2023-01-25 11:45:20","customer_id":24,"date_of_birth":"1987-07-22","email":"luciana.teixeira@email.com","employment_status":"Self-employed","first_name":"Luciana","last_name":"Teixeira","phone_number":"+5511976543287","updated_at":"2023-02-12 09:35:28"},{"annual_income":90000,"created_at":"2023-02-10 14:10:42","customer_id":25,"date_of_birth":"1974-11-13","email":"roberto.lopes@email.com","employment_status":"Employed","first_name":"Roberto","last_name":"Lopes","phone_number":"+5531965432187","updated_at":"2023-02-28 17:24:19"},{"annual_income":20000,"created_at":"2022-01-30 13:25:18","customer_id":26,"date_of_birth":"1992-04-06","email":"monica.azevedo@email.com","employment_status":"Student","first_name":"Monica","last_name":"Azevedo","phone_number":"+5511987654387","updated_at":"2022-10-15 11:33:47"},{"annual_income":79000,"created_at":"2022-02-18 16:40:33","customer_id":27,"date_of_birth":"1983-08-29","email":"henrique.barros@email.com","employment_status":"Employed","first_name":"Henrique","last_name":"Barros","phone_number":"+5521976543287","updated_at":"2022-11-22 15:26:55"},{"annual_income":0,"created_at":"2022-03-10 08:15:55","customer_id":28,"date_of_birth":"1994-01-14","email":"bianca.pinto@email.com","employment_status":"Unemployed","first_name":"Bianca","last_name":"Pinto","phone_number":"+5511965432154","updated_at":"2022-12-05 10:19:34"},{"annual_income":98000,"created_at":"2022-03-29 10:50:20","customer_id":29,"date_of_birth":"1977-06-27","email":"fabio.freitas@email.com","employment_status":"Self-employed","first_name":"Fabio","last_name":"Freitas","phone_number":"+5551987654387","updated_at":"2023-01-18 16:41:22"},{"annual_income":67000,"created_at":"2022-04-15 15:35:45","customer_id":30,"date_of_birth":"1989-10-10","email":"daniela.fonseca@email.com","employment_status":"Employed","first_name":"Daniela","last_name":"Fonseca","phone_number":"+5511976543276","updated_at":"2022-09-12 13:54:28"},{"annual_income":91000,"created_at":"2022-05-02 09:20:12","customer_id":31,"date_of_birth":"1980-04-03","email":"marcelo.andrade@email.com","employment_status":"Employed","first_name":"Marcelo","last_name":"Andrade","phone_number":"+5521965432143","updated_at":"2022-10-28 17"},{"annual_income":null,"created_at":null,"customer_id":null,"date_of_birth":null,"email":null,"employment_status":null,"first_name":null,"last_name":null,"phone_number":null,"updated_at":null}]],["1741735846342",[{"annual_income":null,"created_at":null,"customer_id":null,"date_of_birth":null,"email":"email","employment_status":"employment_status","first_name":"first_name","last_name":"last_name","phone_number":"phone_number","updated_at":null},{"annual_income":"75000","created_at":"2022-01-15 08:30:00","customer_id":1,"date_of_birth":"1985-03-12","email":"joao.silva@email.com","employment_status":"Employed","first_name":"João","last_name":"Silva","phone_number":"+5511987654321","updated_at":"2022-11-28 14:15:22"},{"annual_income":"92000","created_at":"2022-02-03 10:15:45","customer_id":2,"date_of_birth":"1990-07-25","email":"maria.santos@email.com","employment_status":"Self-employed","first_name":"Maria","last_name":"Santos","phone_number":"+5511976543210","updated_at":"2022-10-12 09:34:17"},{"annual_income":"68000","created_at":"2022-02-10 14:20:33","customer_id":3,"date_of_birth":"1978-11-30","email":"carlos.ferreira@email.com","employment_status":"Employed","first_name":"Carlos","last_name":"Ferreira","phone_number":"+5521998765432","updated_at":"2022-09-05 16:45:08"},{"annual_income":"0","created_at":"2022-03-05 09:45:12","customer_id":4,"date_of_birth":"1992-05-18","email":"ana.oliveira@email.com","employment_status":"Unemployed","first_name":"Ana","last_name":"Oliveira","phone_number":"+5511965432109","updated_at":"2023-01-10 11:22:45"},{"annual_income":"85000","created_at":"2022-03-18 11:30:27","customer_id":5,"date_of_birth":"1983-09-07","email":"pedro.souza@email.com","employment_status":"Employed","first_name":"Pedro","last_name":"Souza","phone_number":"+5531987654321","updated_at":"2022-12-07 15:37:29"},{"annual_income":"12000","created_at":"2022-04-02 16:25:40","customer_id":6,"date_of_birth":"1995-01-22","email":"juliana.costa@email.com","employment_status":"Student","first_name":"Juliana","last_name":"Costa","phone_number":"+5511954321098","updated_at":"2023-02-15 10:18:33"},{"annual_income":"110000","created_at":"2022-04-20 13:10:55","customer_id":7,"date_of_birth":"1980-06-14","email":"rafael.almeida@email.com","employment_status":"Employed","first_name":"Rafael","last_name":"Almeida","phone_number":"+5541976543210","updated_at":"2022-08-30 17:29:41"},{"annual_income":"78000","created_at":"2022-05-08 15:45:22","customer_id":8,"date_of_birth":"1988-04-09","email":"fernanda.lima@email.com","employment_status":"Self-employed","first_name":"Fernanda","last_name":"Lima","phone_number":"+5511965432187","updated_at":"2023-01-25 09:48:12"},{"annual_income":"95000","created_at":"2022-05-17 10:35:18","customer_id":9,"date_of_birth":"1975-12-03","email":"bruno.martins@email.com","employment_status":"Employed","first_name":"Bruno","last_name":"Martins","phone_number":"+5521987654321","updated_at":"2022-12-19 14:56:38"},{"annual_income":"0","created_at":"2022-06-01 12:20:33","customer_id":10,"date_of_birth":"1993-08-16","email":"camila.rodrigues@email.com","employment_status":"Unemployed","first_name":"Camila","last_name":"Rodrigues","phone_number":"+5511976543219","updated_at":"2022-11-05 16:24:59"},{"annual_income":"72000","created_at":"2022-06-15 14:55:47","customer_id":11,"date_of_birth":"1982-02-28","email":"lucas.pereira@email.com","employment_status":"Employed","first_name":"Lucas","last_name":"Pereira","phone_number":"+5531998765432","updated_at":"2023-02-02 10:37:14"},{"annual_income":"15000","created_at":"2022-07-03 09:30:22","customer_id":12,"date_of_birth":"1991-10-11","email":"amanda.gomes@email.com","employment_status":"Student","first_name":"Amanda","last_name":"Gomes","phone_number":"+5511965432198","updated_at":"2022-09-28 15:42:31"},{"annual_income":"120000","created_at":"2022-07-18 11:15:45","customer_id":13,"date_of_birth":"1977-04-24","email":"diego.ribeiro@email.com","employment_status":"Self-employed","first_name":"Diego","last_name":"Ribeiro","phone_number":"+5551987654321","updated_at":"2023-01-15 13:19:47"},{"annual_income":"65000","created_at":"2022-08-02 15:40:12","customer_id":14,"date_of_birth":"1994-07-07","email":"patricia.castro@email.com","employment_status":"Employed","first_name":"Patricia","last_name":"Castro","phone_number":"+5511976543291","updated_at":"2022-12-10 11:28:33"},{"annual_income":"88000","created_at":"2022-08-20 10:25:38","customer_id":15,"date_of_birth":"1981-11-19","email":"gustavo.nunes@email.com","employment_status":"Employed","first_name":"Gustavo","last_name":"Nunes","phone_number":"+5521965432109","updated_at":"2023-02-20 16:44:22"},{"annual_income":"0","created_at":"2022-09-05 13:50:27","customer_id":16,"date_of_birth":"1989-03-02","email":"renata.barbosa@email.com","employment_status":"Unemployed","first_name":"Renata","last_name":"Barbosa","phone_number":"+5511987654329","updated_at":"2022-10-30 09:53:41"},{"annual_income":"105000","created_at":"2022-09-22 16:35:50","customer_id":17,"date_of_birth":"1976-08-15","email":"eduardo.cardoso@email.com","employment_status":"Employed","first_name":"Eduardo","last_name":"Cardoso","phone_number":"+5541976543219","updated_at":"2023-01-08 14:36:19"},{"annual_income":"18000","created_at":"2022-10-10 08:55:33","customer_id":18,"date_of_birth":"1993-01-31","email":"carla.nascimento@email.com","employment_status":"Student","first_name":"Carla","last_name":"Nascimento","phone_number":"+5511965432176","updated_at":"2022-12-25 17:21:48"},{"annual_income":"96000","created_at":"2022-10-28 12:40:18","customer_id":19,"date_of_birth":"1984-06-26","email":"ricardo.moreira@email.com","employment_status":"Self-employed","first_name":"Ricardo","last_name":"Moreira","phone_number":"+5531987654329","updated_at":"2023-02-10 11:45:27"},{"annual_income":"70000","created_at":"2022-11-15 14:15:42","customer_id":20,"date_of_birth":"1990-12-09","email":"vanessa.dias@email.com","employment_status":"Employed","first_name":"Vanessa","last_name":"Dias","phone_number":"+5511976543298","updated_at":"2023-01-30 15:38:55"},{"annual_income":"82000","created_at":"2022-12-03 10:30:15","customer_id":21,"date_of_birth":"1979-05-20","email":"fernando.rocha@email.com","employment_status":"Employed","first_name":"Fernando","last_name":"Rocha","phone_number":"+5521998765439","updated_at":"2023-02-25 10:22:14"},{"annual_income":"0","created_at":"2022-12-20 15:55:33","customer_id":22,"date_of_birth":"1995-09-04","email":"debora.cavalcanti@email.com","employment_status":"Unemployed","first_name":"Débora","last_name":"Cavalcanti","phone_number":"+5511965432165","updated_at":"2023-02-18 16:49:33"},{"annual_income":"115000","created_at":"2023-01-08 09:20:55","customer_id":23,"date_of_birth":"1981-02-17","email":"alessandro.vieira@email.com","employment_status":"Employed","first_name":"Alessandro","last_name":"Vieira","phone_number":"+5541987654328","updated_at":"2023-02-05 13:57:42"},{"annual_income":"75000","created_at":"2023-01-25 11:45:20","customer_id":24,"date_of_birth":"1987-07-22","email":"luciana.teixeira@email.com","employment_status":"Self-employed","first_name":"Luciana","last_name":"Teixeira","phone_number":"+5511976543287","updated_at":"2023-02-12 09:35:28"},{"annual_income":"90000","created_at":"2023-02-10 14:10:42","customer_id":25,"date_of_birth":"1974-11-13","email":"roberto.lopes@email.com","employment_status":"Employed","first_name":"Roberto","last_name":"Lopes","phone_number":"+5531965432187","updated_at":"2023-02-28 17:24:19"},{"annual_income":"20000","created_at":"2022-01-30 13:25:18","customer_id":26,"date_of_birth":"1992-04-06","email":"monica.azevedo@email.com","employment_status":"Student","first_name":"Monica","last_name":"Azevedo","phone_number":"+5511987654387","updated_at":"2022-10-15 11:33:47"},{"annual_income":"79000","created_at":"2022-02-18 16:40:33","customer_id":27,"date_of_birth":"1983-08-29","email":"henrique.barros@email.com","employment_status":"Employed","first_name":"Henrique","last_name":"Barros","phone_number":"+5521976543287","updated_at":"2022-11-22 15:26:55"},{"annual_income":"0","created_at":"2022-03-10 08:15:55","customer_id":28,"date_of_birth":"1994-01-14","email":"bianca.pinto@email.com","employment_status":"Unemployed","first_name":"Bianca","last_name":"Pinto","phone_number":"+5511965432154","updated_at":"2022-12-05 10:19:34"},{"annual_income":"98000","created_at":"2022-03-29 10:50:20","customer_id":29,"date_of_birth":"1977-06-27","email":"fabio.freitas@email.com","employment_status":"Self-employed","first_name":"Fabio","last_name":"Freitas","phone_number":"+5551987654387","updated_at":"2023-01-18 16:41:22"},{"annual_income":"67000","created_at":"2022-04-15 15:35:45","customer_id":30,"date_of_birth":"1989-10-10","email":"daniela.fonseca@email.com","employment_status":"Employed","first_name":"Daniela","last_name":"Fonseca","phone_number":"+5511976543276","updated_at":"2022-09-12 13:54:28"},{"annual_income":"91000","created_at":"2022-05-02 09:20:12","customer_id":31,"date_of_birth":"1980-04-03","email":"marcelo.andrade@email.com","employment_status":"Employed","first_name":"Marcelo","last_name":"Andrade","phone_number":"+5521965432143","updated_at":"2022-10-28 17:00:00"},{"annual_income":null,"created_at":null,"customer_id":null,"date_of_birth":null,"email":null,"employment_status":null,"first_name":null,"last_name":null,"phone_number":null,"updated_at":null}]],["1741735933013",[]],["1741737341721",[{"annual_income":"75000","created_at":"2022-01-15 08:30:00","customer_id":1,"date_of_birth":"1985-03-12","email":"joao.silva@email.com","employment_status":"Employed","first_name":"João","last_name":"Silva","phone_number":"+5511987654321","updated_at":"2022-11-28 14:15:22"},{"annual_income":"92000","created_at":"2022-02-03 10:15:45","customer_id":2,"date_of_birth":"1990-07-25","email":"maria.santos@email.com","employment_status":"Self-employed","first_name":"Maria","last_name":"Santos","phone_number":"+5511976543210","updated_at":"2022-10-12 09:34:17"},{"annual_income":"68000","created_at":"2022-02-10 14:20:33","customer_id":3,"date_of_birth":"1978-11-30","email":"carlos.ferreira@email.com","employment_status":"Employed","first_name":"Carlos","last_name":"Ferreira","phone_number":"+5521998765432","updated_at":"2022-09-05 16:45:08"},{"annual_income":"0","created_at":"2022-03-05 09:45:12","customer_id":4,"date_of_birth":"1992-05-18","email":"ana.oliveira@email.com","employment_status":"Unemployed","first_name":"Ana","last_name":"Oliveira","phone_number":"+5511965432109","updated_at":"2023-01-10 11:22:45"},{"annual_income":"85000","created_at":"2022-03-18 11:30:27","customer_id":5,"date_of_birth":"1983-09-07","email":"pedro.souza@email.com","employment_status":"Employed","first_name":"Pedro","last_name":"Souza","phone_number":"+5531987654321","updated_at":"2022-12-07 15:37:29"},{"annual_income":"12000","created_at":"2022-04-02 16:25:40","customer_id":6,"date_of_birth":"1995-01-22","email":"juliana.costa@email.com","employment_status":"Student","first_name":"Juliana","last_name":"Costa","phone_number":"+5511954321098","updated_at":"2023-02-15 10:18:33"},{"annual_income":"110000","created_at":"2022-04-20 13:10:55","customer_id":7,"date_of_birth":"1980-06-14","email":"rafael.almeida@email.com","employment_status":"Employed","first_name":"Rafael","last_name":"Almeida","phone_number":"+5541976543210","updated_at":"2022-08-30 17:29:41"},{"annual_income":"78000","created_at":"2022-05-08 15:45:22","customer_id":8,"date_of_birth":"1988-04-09","email":"fernanda.lima@email.com","employment_status":"Self-employed","first_name":"Fernanda","last_name":"Lima","phone_number":"+5511965432187","updated_at":"2023-01-25 09:48:12"},{"annual_income":"95000","created_at":"2022-05-17 10:35:18","customer_id":9,"date_of_birth":"1975-12-03","email":"bruno.martins@email.com","employment_status":"Employed","first_name":"Bruno","last_name":"Martins","phone_number":"+5521987654321","updated_at":"2022-12-19 14:56:38"},{"annual_income":"0","created_at":"2022-06-01 12:20:33","customer_id":10,"date_of_birth":"1993-08-16","email":"camila.rodrigues@email.com","employment_status":"Unemployed","first_name":"Camila","last_name":"Rodrigues","phone_number":"+5511976543219","updated_at":"2022-11-05 16:24:59"},{"annual_income":"72000","created_at":"2022-06-15 14:55:47","customer_id":11,"date_of_birth":"1982-02-28","email":"lucas.pereira@email.com","employment_status":"Employed","first_name":"Lucas","last_name":"Pereira","phone_number":"+5531998765432","updated_at":"2023-02-02 10:37:14"},{"annual_income":"15000","created_at":"2022-07-03 09:30:22","customer_id":12,"date_of_birth":"1991-10-11","email":"amanda.gomes@email.com","employment_status":"Student","first_name":"Amanda","last_name":"Gomes","phone_number":"+5511965432198","updated_at":"2022-09-28 15:42:31"},{"annual_income":"120000","created_at":"2022-07-18 11:15:45","customer_id":13,"date_of_birth":"1977-04-24","email":"diego.ribeiro@email.com","employment_status":"Self-employed","first_name":"Diego","last_name":"Ribeiro","phone_number":"+5551987654321","updated_at":"2023-01-15 13:19:47"},{"annual_income":"65000","created_at":"2022-08-02 15:40:12","customer_id":14,"date_of_birth":"1994-07-07","email":"patricia.castro@email.com","employment_status":"Employed","first_name":"Patricia","last_name":"Castro","phone_number":"+5511976543291","updated_at":"2022-12-10 11:28:33"},{"annual_income":"88000","created_at":"2022-08-20 10:25:38","customer_id":15,"date_of_birth":"1981-11-19","email":"gustavo.nunes@email.com","employment_status":"Employed","first_name":"Gustavo","last_name":"Nunes","phone_number":"+5521965432109","updated_at":"2023-02-20 16:44:22"},{"annual_income":"0","created_at":"2022-09-05 13:50:27","customer_id":16,"date_of_birth":"1989-03-02","email":"renata.barbosa@email.com","employment_status":"Unemployed","first_name":"Renata","last_name":"Barbosa","phone_number":"+5511987654329","updated_at":"2022-10-30 09:53:41"},{"annual_income":"105000","created_at":"2022-09-22 16:35:50","customer_id":17,"date_of_birth":"1976-08-15","email":"eduardo.cardoso@email.com","employment_status":"Employed","first_name":"Eduardo","last_name":"Cardoso","phone_number":"+5541976543219","updated_at":"2023-01-08 14:36:19"},{"annual_income":"18000","created_at":"2022-10-10 08:55:33","customer_id":18,"date_of_birth":"1993-01-31","email":"carla.nascimento@email.com","employment_status":"Student","first_name":"Carla","last_name":"Nascimento","phone_number":"+5511965432176","updated_at":"2022-12-25 17:21:48"},{"annual_income":"96000","created_at":"2022-10-28 12:40:18","customer_id":19,"date_of_birth":"1984-06-26","email":"ricardo.moreira@email.com","employment_status":"Self-employed","first_name":"Ricardo","last_name":"Moreira","phone_number":"+5531987654329","updated_at":"2023-02-10 11:45:27"},{"annual_income":"70000","created_at":"2022-11-15 14:15:42","customer_id":20,"date_of_birth":"1990-12-09","email":"vanessa.dias@email.com","employment_status":"Employed","first_name":"Vanessa","last_name":"Dias","phone_number":"+5511976543298","updated_at":"2023-01-30 15:38:55"},{"annual_income":"82000","created_at":"2022-12-03 10:30:15","customer_id":21,"date_of_birth":"1979-05-20","email":"fernando.rocha@email.com","employment_status":"Employed","first_name":"Fernando","last_name":"Rocha","phone_number":"+5521998765439","updated_at":"2023-02-25 10:22:14"},{"annual_income":"0","created_at":"2022-12-20 15:55:33","customer_id":22,"date_of_birth":"1995-09-04","email":"debora.cavalcanti@email.com","employment_status":"Unemployed","first_name":"Débora","last_name":"Cavalcanti","phone_number":"+5511965432165","updated_at":"2023-02-18 16:49:33"},{"annual_income":"115000","created_at":"2023-01-08 09:20:55","customer_id":23,"date_of_birth":"1981-02-17","email":"alessandro.vieira@email.com","employment_status":"Employed","first_name":"Alessandro","last_name":"Vieira","phone_number":"+5541987654328","updated_at":"2023-02-05 13:57:42"},{"annual_income":"75000","created_at":"2023-01-25 11:45:20","customer_id":24,"date_of_birth":"1987-07-22","email":"luciana.teixeira@email.com","employment_status":"Self-employed","first_name":"Luciana","last_name":"Teixeira","phone_number":"+5511976543287","updated_at":"2023-02-12 09:35:28"},{"annual_income":"90000","created_at":"2023-02-10 14:10:42","customer_id":25,"date_of_birth":"1974-11-13","email":"roberto.lopes@email.com","employment_status":"Employed","first_name":"Roberto","last_name":"Lopes","phone_number":"+5531965432187","updated_at":"2023-02-28 17:24:19"},{"annual_income":"20000","created_at":"2022-01-30 13:25:18","customer_id":26,"date_of_birth":"1992-04-06","email":"monica.azevedo@email.com","employment_status":"Student","first_name":"Monica","last_name":"Azevedo","phone_number":"+5511987654387","updated_at":"2022-10-15 11:33:47"},{"annual_income":"79000","created_at":"2022-02-18 16:40:33","customer_id":27,"date_of_birth":"1983-08-29","email":"henrique.barros@email.com","employment_status":"Employed","first_name":"Henrique","last_name":"Barros","phone_number":"+5521976543287","updated_at":"2022-11-22 15:26:55"},{"annual_income":"0","created_at":"2022-03-10 08:15:55","customer_id":28,"date_of_birth":"1994-01-14","email":"bianca.pinto@email.com","employment_status":"Unemployed","first_name":"Bianca","last_name":"Pinto","phone_number":"+5511965432154","updated_at":"2022-12-05 10:19:34"},{"annual_income":"98000","created_at":"2022-03-29 10:50:20","customer_id":29,"date_of_birth":"1977-06-27","email":"fabio.freitas@email.com","employment_status":"Self-employed","first_name":"Fabio","last_name":"Freitas","phone_number":"+5551987654387","updated_at":"2023-01-18 16:41:22"},{"annual_income":"67000","created_at":"2022-04-15 15:35:45","customer_id":30,"date_of_birth":"1989-10-10","email":"daniela.fonseca@email.com","employment_status":"Employed","first_name":"Daniela","last_name":"Fonseca","phone_number":"+5511976543276","updated_at":"2022-09-12 13:54:28"},{"annual_income":"91000","created_at":"2022-05-02 09:20:12","customer_id":31,"date_of_birth":"1980-04-03","email":"marcelo.andrade@email.com","employment_status":"Employed","first_name":"Marcelo","last_name":"Andrade","phone_number":"+5521965432143","updated_at":"2022-10-28 17:00:00"}]]],"statementsMap":[["1741735513513",{"nodeId":"1741735513513","codeSnippet":"# Script generated for node CatalogDataSource\nCatalogDataSource_1741735513513 = spark.sql(\"select * from `glue_db_ay30a66r3fs2sb`.`customers_details_raw`\")","executionState":"STALE","executorCode":["# Script generated for node CatalogDataSource\nCatalogDataSource_1741735513513 = spark.sql(\"select * from `glue_db_ay30a66r3fs2sb`.`customers_details_raw`\")","outputCatalogDataSource_1741735513513 = json.dumps({\"Schema\": CatalogDataSource_1741735513513.schema.jsonValue(), \"DataSample\": [row.asDict() for row in CatalogDataSource_1741735513513.take(100)]}, indent=2, sort_keys=True, default=str)","print(outputCatalogDataSource_1741735513513)"]}],["1741735846342",{"nodeId":"1741735846342","codeSnippet":"from pyspark.sql.functions import *\n\n# Script generated for node WithColumnsTransform\nWithColumnsTransform_1741735846342 = CatalogDataSource_1741735513513.withColumns({\"customer_id\": col(\"customer_id\").cast(\"bigint\"), \"first_name\": col(\"first_name\").cast(\"string\"), \"last_name\": col(\"last_name\").cast(\"string\"), \"date_of_birth\": col(\"date_of_birth\").cast(\"date\"), \"email\": col(\"email\").cast(\"string\"), \"phone_number\": col(\"phone_number\").cast(\"string\"), \"employment_status\": col(\"employment_status\").cast(\"string\"), \"annual_income\": col(\"annual_income\").cast(\"decimal\"), \"created_at\": col(\"created_at\").cast(\"timestamp\"), \"updated_at\": col(\"updated_at\").cast(\"timestamp\")})","executionState":"STALE","executorCode":["from pyspark.sql.functions import *\n\n# Script generated for node WithColumnsTransform\nWithColumnsTransform_1741735846342 = CatalogDataSource_1741735513513.withColumns({\"customer_id\": col(\"customer_id\").cast(\"bigint\"), \"first_name\": col(\"first_name\").cast(\"string\"), \"last_name\": col(\"last_name\").cast(\"string\"), \"date_of_birth\": col(\"date_of_birth\").cast(\"date\"), \"email\": col(\"email\").cast(\"string\"), \"phone_number\": col(\"phone_number\").cast(\"string\"), \"employment_status\": col(\"employment_status\").cast(\"string\"), \"annual_income\": col(\"annual_income\").cast(\"decimal\"), \"created_at\": col(\"created_at\").cast(\"timestamp\"), \"updated_at\": col(\"updated_at\").cast(\"timestamp\")})","outputWithColumnsTransform_1741735846342 = json.dumps({\"Schema\": WithColumnsTransform_1741735846342.schema.jsonValue(), \"DataSample\": [row.asDict() for row in WithColumnsTransform_1741735846342.take(100)]}, indent=2, sort_keys=True, default=str)","print(outputWithColumnsTransform_1741735846342)"]}],["1741737341721",{"nodeId":"1741737341721","codeSnippet":"# Script generated for node FilterTransform\nFilterTransform_1741737341721 = WithColumnsTransform_1741735846342.filter(\"`first_name` != 'first_name'\")","executionState":"STALE","executorCode":["# Script generated for node FilterTransform\nFilterTransform_1741737341721 = WithColumnsTransform_1741735846342.filter(\"`first_name` != 'first_name'\")","outputFilterTransform_1741737341721 = json.dumps({\"Schema\": FilterTransform_1741737341721.schema.jsonValue(), \"DataSample\": [row.asDict() for row in FilterTransform_1741737341721.take(100)]}, indent=2, sort_keys=True, default=str)","print(outputFilterTransform_1741737341721)"]}]],"createSessionRequest":{"Role":"arn:aws:iam::577638381635:role/datazone_usr_role_5ogmezbasmyi6z_6kizdce0xmbvyz","Connections":{"Connections":["datazone-glue-network-connection-5ogmezbasmyi6z-dev"]},"Command":{"Name":"glueetl","PythonVersion":"3"},"DefaultArguments":{"--enable-glue-datacatalog":"true","--enable-auto-scaling":"true","--project_s3_path":"s3://amazon-sagemaker-577638381635-sa-east-1-3a24c0d9beaf/dzd_cjfgk2iz50fxp7/5ogmezbasmyi6z/dev","--redshift_iam_role":"arn:aws:iam::577638381635:role/datazone_usr_role_5ogmezbasmyi6z_6kizdce0xmbvyz","--redshift_tempdir":"s3://amazon-sagemaker-577638381635-sa-east-1-3a24c0d9beaf/dzd_cjfgk2iz50fxp7/5ogmezbasmyi6z/dev/redshift-tmp/","--enable-lakeformation-fine-grained-access":"false","--datalake-formats":"iceberg","--conf":"spark.sql.defaultCatalog=spark_catalog --conf spark.sql.extensions=org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions --conf spark.datasource.redshift.community.glue_endpoint=https://glue.sa-east-1.amazonaws.com --conf spark.datasource.redshift.community.data_api_endpoint=https://redshift-data.sa-east-1.amazonaws.com --conf spark.hadoop.fs.s3.impl=com.amazon.ws.emr.hadoop.fs.EmrFileSystem --conf spark.sql.catalog.spark_catalog=org.apache.iceberg.spark.SparkSessionCatalog --conf spark.sql.catalog.spark_catalog.catalog-impl=org.apache.iceberg.aws.glue.GlueCatalog --conf spark.sql.catalog.spark_catalog.glue.id=577638381635 --conf spark.sql.catalog.spark_catalog.glue.endpoint=https://glue.sa-east-1.amazonaws.com --conf spark.sql.catalog.spark_catalog.client.region=sa-east-1"},"GlueVersion":"5.0","RequestOrigin":"SageMakerUnifiedStudio_VisualETLDataPreview","Timeout":60,"IdleTimeout":15,"NumberOfWorkers":4,"WorkerType":"G.1X","Tags":{"AmazonDataZoneEnvironment":"6kizdce0xmbvyz","AmazonDataZoneProject":"5ogmezbasmyi6z","AmazonDataZoneDomain":"dzd_cjfgk2iz50fxp7"}},"createSessionAdhocRequest":{"Role":"arn:aws:iam::577638381635:role/datazone_usr_role_5ogmezbasmyi6z_6kizdce0xmbvyz","Connections":{"Connections":["datazone-glue-network-connection-5ogmezbasmyi6z-dev"]},"Command":{"Name":"glueetl","PythonVersion":"3"},"DefaultArguments":{"--enable-glue-datacatalog":"true","--enable-auto-scaling":"true","--project_s3_path":"s3://amazon-sagemaker-577638381635-sa-east-1-3a24c0d9beaf/dzd_cjfgk2iz50fxp7/5ogmezbasmyi6z/dev","--redshift_iam_role":"arn:aws:iam::577638381635:role/datazone_usr_role_5ogmezbasmyi6z_6kizdce0xmbvyz","--redshift_tempdir":"s3://amazon-sagemaker-577638381635-sa-east-1-3a24c0d9beaf/dzd_cjfgk2iz50fxp7/5ogmezbasmyi6z/dev/redshift-tmp/","--enable-lakeformation-fine-grained-access":"false","--datalake-formats":"iceberg","--conf":"spark.sql.defaultCatalog=spark_catalog --conf spark.sql.extensions=org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions --conf spark.datasource.redshift.community.glue_endpoint=https://glue.sa-east-1.amazonaws.com --conf spark.datasource.redshift.community.data_api_endpoint=https://redshift-data.sa-east-1.amazonaws.com --conf spark.hadoop.fs.s3.impl=com.amazon.ws.emr.hadoop.fs.EmrFileSystem --conf spark.sql.catalog.spark_catalog=org.apache.iceberg.spark.SparkSessionCatalog --conf spark.sql.catalog.spark_catalog.catalog-impl=org.apache.iceberg.aws.glue.GlueCatalog --conf spark.sql.catalog.spark_catalog.glue.id=577638381635 --conf spark.sql.catalog.spark_catalog.glue.endpoint=https://glue.sa-east-1.amazonaws.com --conf spark.sql.catalog.spark_catalog.client.region=sa-east-1"},"GlueVersion":"5.0","RequestOrigin":"SageMakerUnifiedStudio_VisualETLDataPreview","Timeout":60,"IdleTimeout":5,"NumberOfWorkers":4,"WorkerType":"G.1X","Tags":{"AmazonDataZoneEnvironment":"6kizdce0xmbvyz","AmazonDataZoneProject":"5ogmezbasmyi6z","AmazonDataZoneDomain":"dzd_cjfgk2iz50fxp7"}},"dpSettings":{"autoImportLibs":true,"autoRestart":false,"sampleSize":100},"computeConnection":{"configurations":[{"classification":"GlueDefaultArgument","properties":{"--enable-lakeformation-fine-grained-access":"false"}}],"domainIdentifier":"dzd_cjfgk2iz50fxp7","projectIdentifier":"5ogmezbasmyi6z","environmentIdentifier":"6kizdce0xmbvyz","connectionIdentifier":"46pqjt3e5mto9n","name":"project.spark.compatibility","type":"SPARK","authorizationMode":"PROJECT","provisioningType":"MANAGED","location":{"awsRegion":"sa-east-1","awsAccountId":"577638381635"},"physicalEndpoints":[{"awsLocation":{"awsAccountId":"577638381635","awsRegion":"sa-east-1"},"glueConnectionName":"datazone-glue-network-connection-5ogmezbasmyi6z-dev"}],"sparkGlueProperties":{"glueConnection":{},"sessionConfigs":{"idle_timeout":60,"glue_version":"5.0","worker_type":"G.1X","number_of_workers":10}}}}},"nbformat":4,"nbformat_minor":5}